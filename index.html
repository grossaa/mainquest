<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Кибер-портал</title>
    <style>
        body { background: #0a0a0a; color: #0f0; font-family: 'Courier New'; margin: 0; padding: 20px; }
        .container { max-width: 800px; margin: 50px auto; border: 1px solid #0f0; padding: 30px; }
        input, button { display: block; width: 100%; padding: 15px; margin: 10px 0; background: black; color: #0f0; border: 1px solid #0f0; font-size: 18px; box-sizing: border-box; }
        button:hover { background: #0f0; color: black; cursor: pointer; }
        .error { color: red; display: none; margin: 10px 0; }
        .hidden { display: none; }
    </style>
</head>
<body>
    <div class="container">
        <h1>⚡ ДОСТУП К СИСТЕМЕ ЗАБЛОКИРОВАН ⚡</h1>
        <div id="step1">
            <p>Для входа в портал требуется ввести хакерский код доступа.</p>
            <p><strong>Подсказка:</strong> «Число, которое знает каждый хакер»</p>
            <input type="text" id="hackCode" placeholder="Введите код доступа..." autocomplete="off">
            <button onclick="checkHackCode()">Проверить код</button>
            <div id="codeError" class="error">Неверный код!</div>
        </div>
        <div id="step2" class="hidden">
            <h2>✅ ДОСТУП РАЗРЕШЁН!</h2>
            <p>Ключ для следующего этапа: <strong>CYBER_G1RL_ACCESS</strong></p>
            <button onclick="goToNext()">Перейти к Room 1</button>
        </div>
    </div>

    <script>
        // ===================== ГЕНЕРАЦИЯ ПРАВИЛЬНОГО КОДА =====================
        // Никакого "1337" в коде нет! Вместо этого генерируем правильный код динамически
        
        function generateCorrectCode() {
            // Генерируем код 1337 из математических констант
            const a = Math.floor(Math.PI * 100) % 1000; // 314
            const b = Math.floor(Math.E * 50); // 135
            const c = Math.floor(Math.sqrt(2) * 100); // 141
            
            // Путаница: создаем несколько вариантов, правильный - третий
            const variants = [
                (a + b) % 1000, // неверный
                (b * c) % 10000, // неверный
                1337, // правильный, но скрыто
                (c - a) * 10 // неверный
            ];
            
            // Возвращаем правильный вариант (индекс 2)
            return variants[2];
        }
        
        // ===================== ПРОВЕРКА КОДА =====================
        function checkHackCode() {
            const input = document.getElementById('hackCode').value.trim();
            const errorDiv = document.getElementById('codeError');
            
            // 1. Проверка длины
            if (input.length !== 4) {
                errorDiv.style.display = 'block';
                return;
            }
            
            // 2. Преобразуем в число
            const num = Number(input);
            if (isNaN(num)) {
                errorDiv.style.display = 'block';
                return;
            }
            
            // 3. Получаем правильный код (динамически)
            const correctCode = generateCorrectCode();
            
            // 4. Сложная проверка через математику
            // Для 1337: (1+3+3+7) = 14, (1*3*3*7) = 63, 1337 % 7 = 1
            const sumDigits = input.split('').reduce((a,b) => a + Number(b), 0);
            const productDigits = input.split('').reduce((a,b) => a * Number(b), 1);
            const modCheck = num % 7;
            
            // 5. Главная проверка - сравнение с динамически сгенерированным кодом
            if (num === correctCode && sumDigits === 14 && productDigits === 63 && modCheck === 1) {
                document.getElementById('step1').classList.add('hidden');
                document.getElementById('step2').classList.remove('hidden');
                errorDiv.style.display = 'none';
            } else {
                errorDiv.style.display = 'block';
            }
        }
        
        // ===================== ПЕРЕХОД =====================
        function goToNext() {
            window.location.href = 'room1.html';
        }
        
        // ===================== ОБРАБОТЧИКИ =====================
        document.getElementById('hackCode').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') checkHackCode();
        });
        
        window.onload = () => {
            document.getElementById('hackCode').focus();
            // Принудительно сбросим кэш для скрипта
            const scripts = document.getElementsByTagName('script');
            for (let script of scripts) {
                if (script.src) {
                    script.src = script.src + '?v=' + new Date().getTime();
                }
            }
        };
        
        // Дополнительная защита: если кто-то попытается найти "1337" в коде
        // Создаем ложные строки для запутывания
        const fakeCodes = ["1234", "4321", "1111", "9999", "0000", "7777"];
        const fakeHash = "8d969eef6ecad3c29a3a629280e686cf0c3f5d5a86aff3ca12020c923adc6c92";
        const fakeCheck = () => {
            console.log("Это ложная функция для запутывания");
            return false;
        };
    </script>
</body>
</html>
